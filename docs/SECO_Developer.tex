% Universal LaTeX headers for e-book publications
\documentclass[oneside,10pt]{book}
%% mobile phone optimized papaer size
\usepackage[paperwidth=118.8mm,paperheight=68.2mm,margin=2mm]{geometry}
%% hyperlinks pdf style
\usepackage[unicode,colorlinks=true]{hyperref}
%% fix first title page
\usepackage{atbegshi}\AtBeginDocument{\AtBeginShipoutNext{\AtBeginShipoutDiscard}}
%% font setup for screen reading
\renewcommand{\familydefault}{\sfdefault}\normalfont
%% fix heading styles for tiny paper
\usepackage{titlesec}
\titleformat{\chapter}{\Large\bfseries}{\thechapter.}{1em}{}
\titleformat{\section}{\large\bfseries}{\thesection.}{1em}{}
%% fix contents style
\usepackage{tocloft}
\renewcommand{\cfttoctitlefont}{\Large}
\renewcommand{\cftbeforetoctitleskip}{0mm}
\renewcommand{\cftaftertoctitleskip}{1em}
\renewcommand{\cftchapfont}{\bfseries}
\renewcommand{\cftbeforechapskip}{0.2em}
\renewcommand{\cftsecfont}{}
\renewcommand{\cftsubsecfont}{\it}
\renewcommand{\cftparskip}{0mm}
%% fix heading styles for tiny paper
\usepackage{titlesec}
\titleformat{\chapter}{\Large\bfseries}{\thechapter.}{1em}{}
\titlespacing{\chapter}{0em}{0em}{0.5em}
\titleformat{\section}{\large\bfseries}{\thesection.}{1em}{}
\titlespacing{\section}{0em}{1em}{0.5em}
\titleformat{\subsection}{\large\bfseries}{\thesubsection.}{1em}{}
\titlespacing{\subsection}{0em}{1em}{0.5em}
%% redefine colors, make it darker
\usepackage{xcolor}
\definecolor{red}{rgb}{0.7,0,0}		% R
\definecolor{green}{rgb}{0,0.6,0}	% G
\definecolor{blue}{rgb}{0,0,0.7}	% B

% images
\usepackage[pdftex]{graphicx}
\newcommand{\fig}[2]{\noindent\includegraphics[#2]{#1}}

% relative sectioning
\usepackage{ifthen}
\newcounter{secdepth}\setcounter{secdepth}{0}
\newcommand{\secup}{\addtocounter{secdepth}{1}}
\newcommand{\secdown}{\addtocounter{secdepth}{-1}}
\newcommand{\secrel}[1]{
\ifthenelse{\equal{\value{secdepth}}{0}}{\part{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-1}}{\chapter{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-2}}{\section{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-3}}{\subsection{#1}}{}
\ifthenelse{\equal{\value{secdepth}}{-4}}{\subsubsection{#1}}{}
}
\newcommand{\secp}[1]{\paragraph{#1}}
\newcommand{\secly}[1]{
\section*{#1}
\addcontentsline{toc}{section}{#1}
}

% hyphenation and localization
\usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel} %,russian

% [nosep] option in lists/enums
\usepackage{enumitem}
% frame box
\usepackage{framed}

% misc
\newcommand{\email}[1]{$<$\href{mailto:#1}{#1}$>$}
\renewcommand{\emph}[1]{\textcolor{red}{#1}}
\newcommand{\note}[1]{\,\footnote{\ #1}}
\newcommand{\term}[1]{\textcolor{green}{#1}}

% listing & computer
\usepackage[os=win]{menukeys}
\usepackage{amssymb} % windows key
\newcommand{\winstart}{$\boxplus$}
\newcommand{\winr}{\keys{\winstart+R}}
\newcommand{\lms}{$\lhd$}
% \newcommand{\dblms}{$\lhd\lhd$}
\newcommand{\rms}{$\rhd$}
\newcommand{\checkbox}{$\boxtimes$}
\newcommand{\uncheckbox}{$\square$}

%% listings
\usepackage{listings}
\lstset{
basicstyle=\small,
frame=single,
numbers=left,numberstyle=\small,numbersep=2mm,
xleftmargin=3mm,xrightmargin=2mm,
tabsize=4,
commentstyle=\color{blue},
}
\newcommand{\lst}[2]{\lstinputlisting[title=#1]{#2}}
\newcommand{\lstx}[3]{\lstinputlisting[title=#1,language=#3]{#2}}

%% languages
\newcommand{\seco}{$Seco$}
\newcommand{\hgdb}{$HyperGraph_{db}$}
\newcommand{\java}{$Java$}
\newcommand{\purec}{$C$}
\newcommand{\cpp}{$C^+_+$}
\newcommand{\prolog}{$Prolog$}

%% OSes
\newcommand{\linux}{$Linux$}
\newcommand{\win}{$Windows$}

%% objects
\newcommand{\file}[1]{\textbf{#1}}
\newcommand{\prog}[1]{\textcolor{blue}{#1}}

%% std.tools
\newcommand{\git}{\prog{git}}
\newcommand{\github}{$GitHub$}
\newcommand{\make}{\prog{make}}
\newcommand{\eclipse}{$Eclipse$}
\newcommand{\gvim}{$(g)Vim$}
\newcommand{\ergo}{$Ergo$}
\newcommand{\flora}{$Flora^2$}

%% misc
\newcommand{\bit}[1]{$_{#1}bit$}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author{\copyright\ Dmitry Ponyatov \email{dponyatov@gmail.com}}
\title{\ \\\ \\Become a Seco Developer\\newbie guide}
\begin{document}
\maketitle
\tableofcontents\secdown
\clearpage

\secly{Intro to Seco IDE}

\seco\ is a collaborative scripting development environment for the \java\
platform. You can write code in many JVM scripting languages. The code editor in
Seco is based on the Mathematica notebook UI, but the full GUI is richer and
much more ambitious. In a notebook, you can mix rich text with code and output,
including interactive components created by your code. This makes Seco into a
live environment because you can evaluate expression and immediately see the
changes to your program.

\begin{description}
\item[GitHub]\ \\
\url{https://github.com/bolerio/seco}
\item[binary release builds]\ \\
\url{https://github.com/bolerio/seco/releases/latest}
\end{description}

You can use \seco\ from prebuild binary archive, but this manual will guide you
to become a developer able to expand \seco\ in ways you want.

\bigskip
This manual appeared when I found
\href{http://www.hypergraphdb.org/}{hypergraphdb} usable in my AI and knowledge
database research. \seco\ was noted as visual tool for experimenting with \hgdb,
and I was impressed by it's compact design. But \seco

\begin{description}[nosep]
\item[\href{https://github.com/bolerio/seco/issues/46}{issue 46}]
lacks of extension for \href{http://xsb.sourceforge.net/}{XSB Prolog} and
\href{http://coherentknowledge.com/comparison-of-ergo-suite-to-flora-2/}{Ergo/Flora}
system and
\item[\href{https://github.com/bolerio/seco/issues/45}{issue 45}]
has some problems and low usability with visual interface.
\end{description}

\bigskip
So I started some development without any notable experience \java\ development,
and add this manual going this way. You can track me on github, but note this is
fork project, and my modifications may be merged into core project:
\url{https://github.com/ponyatov/seco}

\secrel{Fresh taste}\secdown

For first time let's play with prebuild binary release: you will get feel of
Seco without long SDK installation.

\secrel{Workbench install} \secdown

\secrel{\java\ SDK}

\seco\ requires only \java\ RE, but we will install SDK for later use:

\begin{enumerate}[nosep]
\item \url{http://www.oracle.com/technetwork/java/javase/downloads/}
\item \menu{JDK>Download}
\item \menu{Java SE Development Kit 8u131>Accept License Agreement}
\item \menu{jdk-8u131-windows-i586.exe} \bit{32}\ (win32)\\
\menu{jdk-8u131-linux-x64.tar.gz} \bit{64}
\end{enumerate}

\secdown
\secp{\linux}

\begin{verbatim}
ponyatov@debian:~$ tar zx< Download/jdk-8u131-linux-x64.tar.gz
ponyatov@debian:~$ ls -la | grep jdk
drwxr-xr-x  8 ponyatov ponyatov   4096 мар 15 12:35 jdk1.8.0_131
ponyatov@debian:~$ env | grep jdk
PATH=/home/ponyatov/jdk1.8.0_131/bin:/usr/local/bin:/usr/bin:..
JAVA_HOME=/home/ponyatov/jdk1.8.0_131
ponyatov@debian:~$ grep .setenv ~/.profile ~/.xsessionrc
/home/ponyatov/.profile:. ~/.setenv
/home/ponyatov/.xsessionrc:. ~/.setenv

ponyatov@debian:~$ cat ~/.setenv
export JAVA_HOME="/home/ponyatov/jdk1.8.0_131"
export PATH="$JAVA_HOME/bin:$PATH"
\end{verbatim}

\secp{\win}

\begin{enumerate}[nosep]
  \item run installer: \menu{jdk-8u131-windows-i586.exe}
  \item select compiler path: \menu{JDK>C:/Java/jdk}
  \item select runtime path: \menu{JRE>C:/Java/jre}
  \item \menu{\winstart\ Start>Computer>\rms>System properties}
  \item \menu{Environment variables>User variables}
  \item \menu{New>JAVA\_HOME>C:/Java/jdk}
  \item \menu{New>PATH>\%JAVA\_HOME\%/bin;\%JAVA\_HOME\%/../jre/bin}
\end{enumerate}

\bigskip
Check install: \menu{\winr>cmd}
\begin{verbatim}
C:\Users\ponyatov> javac -version
java version 1.8.0_131
C:\Users\ponyatov> java -version
Java(TM) SE Runtime Environment (build 1.8.0_131-3464)
\end{verbatim}

\secup

\clearpage

\secrel{\seco\ prebuild binary distro}

\begin{enumerate}[nosep]
  \item \url{https://github.com/bolerio/seco/releases/latest}
  \item \menu{seco-dist-0.7.0.tgz} \linux\\\menu{seco-dist-0.7.0.zip} \win
\end{enumerate}

\secp{\linux}

\begin{verbatim}
ponyatov@debian:~$ tar zx < Download/seco-dist-0.7.0.tgz
ponyatov@debian:~$ ~/seco/run.sh 
\end{verbatim}

\secp{\win}

\begin{verbatim}
cd C:/Java
unzip C:/Users/ponyatov/Download/seco-dist-0.7.0.zip
C:/Java/seco/run.cmd
\end{verbatim}

\fig{fig/seco1.png}{width=\textwidth}

\noindent
If you fonts looks cut downed by an ax, you can fix \file{seco/run.sh}:
\begin{verbatim}
JAVA_EXEC='java -Dawt.useSystemAAFontSettings=lcd'
\end{verbatim}
\fig{fig/seco2.png}{width=\textwidth}

\secup

\secrel{Using \seco}\secdown

Some YouTube videos on using \seco:
  \href{https://www.youtube.com/watch?v=ktOzFNKrCpE}{Installation}
  
  You just have done this

\secrel{Notebook in Niche}
  
  \href{https://www.youtube.com/watch?v=09Te_nSyHUA}{Notebooks}
  idea goes from interface of well-known computational and analytical
  math packages, preferrably Mathematica, and others\ --- Maxima, MathCAD,
  Axiom,\ldots
  
  Each \term{notebook}\ looks like linear document, composed from \term{cell}s.
  Cell can contain formatted text, code on some scripting language\note{code in
  Mathematica/Maxima syntax for example}, result of previous script cell
  execution, plot, image, interactive form,\ldots
  Cells can be grouped and folded/unfolded to hide information not used in this
  moment.
  
  The cell types are essentially three: \emph{input}, \emph{output} and
  \emph{documentation} cells.
  
  \seco\ uses some sort of graph database for storing data, so it uses
  \term{niche}s to group and store notebooks and other working data.
  You can think about \term{niche}\ as some sort of \emph{knowledge database}.
  Starting \seco\ for first time you can get dialog asking of new niche
  creation. In this case you should select storage directory including niche
  name as last name element. If you have no dialog on \seco\ start, look on
\begin{verbatim}
ponyatov@debian:~$ ls -la ~ |grep .seco
drwxr-xr-x  2 ponyatov ponyatov   .secoDefaultNiche
drwxr-xr-x  2 ponyatov ponyatov   .secoRepository

.secoDefaultNiche/:
00000000.jdb  hgdbversion  je.info.0  je.lck

.secoRepository/:
00000000.jdb  hgdbversion  je.info.0  je.lck
\end{verbatim}

\noindent  
Create new notebook for experiments: \menu{Notebook>New} or \keys{Ctrl+N}

\noindent  
You'll get new empty notebook tab \menu{CG},\\
rename it \menu{CG>\rms>Rename>Tutorial}
\bigskip

Now click in empty notebook, you will see horisontal line, points to current
entry cell. Start typing \menu{hello}, and you will see new cell.

\bigskip
\fig{fig/hello.png}{width=0.8\textwidth}\\
By default \seco\ creates script cells using \java-like scripting language
\href{http://www.beanshell.org/manual/quickstart.html}{beanshell}

\clearpage
Cell can be evaluated in place: press \keys{Shift+Enter} when your cursor 
in cell.
\begin{verbatim}
hello

null
\end{verbatim}

Hmm, something strange, fix it:

\begin{verbatim}
"hello"

hello
\end{verbatim}

So, \verb$"text"$ in double quots is \term{string} literal. BeanShell
interpreter evaluates it as string and puts into output cell as is.

\clearpage\noindent
You ever can use GUI elements in output:
\fig{fig/hellobtn.png}{height=0.3\textheight}

\bigskip
For documenting your code you must have ability to make just formatted text,
\seco\ provides this by changing input cell type to HTML. Move your cursor to
the beginning of notebook by \keys{Ctrl+Home} and input:
\begin{verbatim}
This demo code will be used in SECO_Developer tutorial
\end{verbatim}

Then press \keys{Ctrl+Space} and select \menu{html} input syntax. Cell becomes
html cell, it is unevaluable by \keys{Shift+Enter}, but can be viewed in
\emph{html} and \emph{source} form. Use \menu{\rms>Source}, and add header tags:
\begin{verbatim}
<H1>This demo code will be used in SECO_Developer tutorial</H1>
\end{verbatim}
So you can use some basic hmtl tags to format your text, using WISIWIG editor
elements in \emph{html} mode, or by direct tag input in \emph{source} mode.
When you want to switch back into html mode, use \menu{\rms>Cell>Html View}.
Text too large, select it in html view mode, and use drop-down selector in
menu bar to change text style into smaller \verb$h2$ title.
 
\bigskip
\fig{fig/htitle.png}{width=0.95\textwidth}
  
\secrel{User Interface}
 
By default \seco\ runs in tabbed \term{simpleUI} mode. If you want to run it in
mode presented on \href{https://www.youtube.com/watch?v=k9fbOmc2tOk}{this
video}, you should run command line:
\begin{verbatim}
ponyatov@debian:~$ ~/seco/run.sh --simpleUI false &
\end{verbatim}
But this mode was broken in current binary release build (0.7.0).\\
And this is first point to apply some fixes in source code.

\bigskip
Current \seco\ has very limited support of interface for graph manipulation and
data visualization. Lot of work must be applied to expanding interface with
science data vizualization (ParaView bindings), computer science algorithms and
data structures (first of all multilanguage compiler\&translator design and
dynamic memory management), and CAD/CAM visual elements for engineering
applications.

\secup

\clearpage
\input{HyperGraphDB}

\clearpage
\secrel{External Libraries Integration}\secdown
\input{SyntaxParser}
\secup

\secrel{Hacking \seco}\secdown

If you want more complex system, It's time to deep into source.

\secrel{Workbench install}\secdown

\secrel{\git\ client for \github}

\secp{\linux}

\begin{verbatim}
ponyatov@debian:~$ sudo apt install git
[sudo] password for ponyatov: xxxxxxxx
Reading package lists... Done
Building dependency tree
...
\end{verbatim}

\secp{\win}

\url{https://git-scm.com/download/win}

\secp{Register developer account at \github}\ \\

\noindent
If you still have no developer account at \href{https://github.com/}{\github},
you should create it.

\bigskip
\begin{itemize}[nosep]
\item \menu{\href{https://github.com/}{\github}>right-up corner>Sign up}
\item \menu{Username>ponyatov}
\item \menu{Email Address>dponyatov@gmail.com}
\item \menu{Password>*********}
\item \keys{Create an account}
\item \menu{Choose your plan>\checkbox\ Unlimited public repositories for
free>Continue}
\item Verify mailbox by clicking on link in email
\item go to your github account \menu{\url{https://github.com/ponyatov/}}
 
\end{itemize}

\secp{Generating SSH keys}\ \\

\noindent
For \emph{developer} use of \github\ you \emph{must} create and register crypto
keys, as described at
\href{https://help.github.com/articles/connecting-to-github-with-ssh/}{SSH
help}:

\bigskip
\begin{itemize}[nosep]
  \item click in drop-down menu in right-up corner of your github homepage
  \item select \menu{Settings>Personal settings>SSH and GPG keys}
  \item \menu{SSH keys>New SSH key}
  \item open man in new browser tab:
  \href{https://help.github.com/articles/generating-an-ssh-key/}{generating SSH
  keys}
  \item
  \href{https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/}{Generating
  a new SSH key and adding it to the ssh-agent}
\end{itemize}
\begin{verbatim}
ssh-keygen -t rsa -b 4096 -C "bvsaancr@sharklasers.com"
Enter a file ... save the key (/home/you/.ssh/id_rsa): [Enter]
Enter passphrase (empty for no passphrase): [Type a passphrase]
Enter same passphrase again: [Type passphrase again]
\end{verbatim}
\begin{itemize}[nosep]
  \item open file \verb$~/.ssh/id_rsa.pub$ in any text editor and copy it's
  content into clipboard
  \item go back to internet browser with \menu{New SSH key} form
  \item \menu{Title>Debian Linux developer key}
  \item \menu{Key>paste \file{\~{}/.ssh/id\_rsa.pub} contents here}
  \item \keys{Add SSH key}
\item You'll see your new key in list
\end{itemize}
\begin{verbatim}
Debian Linux developer key
Fingerprint: e8:ba:1d:f4:67:ce:02:b9:c8:ee:23:09:e8:1b:b2:ff
\end{verbatim}
\begin{itemize}[nosep]
  \item check your new key by
  \href{https://help.github.com/articles/testing-your-ssh-connection/}{Testing
  your SSH connection} recipe:
\begin{verbatim}
ponyatov@debian:~$ ssh -T git@github.com
Hi ponyatov! You've successfully authenticated,
but GitHub does not provide shell access.
\end{verbatim}
\end{itemize}

\secp{Register SSH keys in \prog{ssh-agent} (\linux\ only)}\ \\

\noindent
Every time you relogin into your \linux\ system, you \emph{must} open terminal
and \emph{register SSH key} in \prog{ssh-agent}:
\begin{verbatim}
ponyatov@debian:~$ ssh-add
Enter passphrase for /home/ponyatov/.ssh/id_rsa: 
Identity added: /home/ponyatov/.ssh/id_rsa (...)
ponyatov@debian:~$ cd seco
ponyatov@debian:~/seco$ git gui &
\end{verbatim}
I still have no idea how to make it automatically from dotfiles, but this step
\emph{required} for \prog{git gui} work when you push local changes into
\github\ repository. If you forgot it, your \prog{git push} in GUI will hangs.
To clean-up this error use 
\begin{verbatim}
ponyatov@debian:~/seco$ killall -9 wish
ponyatov@debian:~/seco$ ssh-add
\end{verbatim}

\secrel{Fork \seco\ source}

\noindent
To do your own development using somebody's project on \github, you \emph{must}
\term{fork} it into \emph{your} \github\ account.

\begin{itemize}[nosep]
  \item go to master \seco\ repository:
  \url{https://github.com/bolerio/seco/}
  \item or my\note{preferrred, I need some practice to write
  section on right pull requesting}\ developer fork
  \url{https://github.com/ponyatov/seco/}
  \item press \keys{Fork}\ button in right up corner
  \item \menu{Where should we fork this repository?>select your account}
  \item Forking ponyatov/seco: it should be some seconds later\ldots 
\end{itemize}
Now you see your new \term{repository}:
\begin{verbatim}
kyjbfjqx/seco
forked from ponyatov/seco
Branch: master
This branch is even with ponyatov:master.
\end{verbatim}
\begin{framed}
Your \term{master} branch must be equal with \emph{upstream} project tree
\end{framed}
This requirement is determined by the need to track all changes made by main
developer or by project maintainers. Tiny projects ordinarily use only
\term{master} branch, more used and large projects use \term{development} branch
and leave master branch for \term{stable releases}.
\begin{framed}
If main team \term{approves} some changes in project, you can pull/merge this
changes into \emph{your} master branch, and then check that all your code in
other branches is compatible with core project evolution.
\end{framed}
Do not do any changes in your master branch\ --- it is reserved exclusively for
origin$\rightarrow$fork changes.
\clearpage

If you forked \emph{my} repo, you also have some branches like \prog{manual},
\prog{fontscale},\ldots\\It is good idea do not override them too to track
fork$\rightarrow$subfork changes. So if you do not plan to do some megaproject,
right way to track your changes is creating unical branches for tiny specific
problems, and do all work in sync with whole developer's team (for example open
bugreports and fix \href{https://github.com/bolerio/seco/issues}{issues
registered in core project}).

\bigskip
Most basics of collaborative work on \github\ covered by this manuals:
\begin{itemize}
  \item \href{https://guides.github.com/activities/forking/}{Forking Projects}
\end{itemize}

\clearpage
\secrel{Clone your \github\ repo locally}

\begin{enumerate}[nosep]
  \item move binary seco to separate folder
\begin{verbatim}
ponyatov@debian:~$ mv seco seco.bin
\end{verbatim} 
\item clone \github\ repo locally into your home dir
\begin{itemize}[nosep]
  \item go to your \url{https://github.com/kyjbfjqx/seco}
  \item click \menu{Clone or download} green button
\item \menu{Clone with>Use SSH>Copy to clipboard}
\end{itemize}
\begin{verbatim}
kyjbfjqx@debian:~$ git clone -o gh --depth=1 \
    git@github.com:kyjbfjqx/seco.git seco
seco Cloning into 'seco'...
remote: Counting objects: 2665, done.
remote: Compressing objects: 100% (1574/1574), done.
Receiving objects:  91% (2432/2665), 14.05 MiB | 926.00 KiB/s   
\end{verbatim}
\item go to cloned repository and move to learning branch  
\begin{verbatim}
kyjbfjqx@debian:~$ cd seco/
kyjbfjqx@debian:~/seco$ git remote add ponyatov \
    git@github.com:ponyatov/seco.git
kyjbfjqx@debian:~/seco$ git checkout -b learning
kyjbfjqx@debian:~/seco$ git branch
* learning
  master
kyjbfjqx@debian:~/seco$ git pull ponyatov learning
kyjbfjqx@debian:~/seco$ git push gh learning
\end{verbatim}
\clearpage
\item create branch using
\href{https://github.com/bolerio/seco/issues/52}{issue} registered on
\href{https://github.com/bolerio/seco/issues}{upstream tracking system}
\begin{verbatim}
kyjbfjqx@debian:~/learning$ git checkout -b issue52 
Switched to a new branch 'issue52'
kyjbfjqx@debian:~/learning$ git branch
* issue52
  learning
  master
kyjbfjqx@debian:~/learning$ git push -u gh issue52
Total 0 (delta 0), reused 0 (delta 0)
To git@github.com:kyjbfjqx/seco.git
 * [new branch]      issue52 -> issue52
Branch issue52 set up to track remote issue52 from gh.
\end{verbatim}
Now you can update \github\ project page in browser and select to your new
branch \menu{Branch>issue52}
\end{enumerate}
 
\clearpage
\input{Eclipse}
\input{gVim}
\secup

\secup

\input{ErgoFlora}

\end{document}
